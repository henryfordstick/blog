# 第四章 正则表达式回溯法原理
回溯也称为试探法，本质上就是深度优先搜索算法，其中退到之前的某一步这一过程，称为”回溯“。
- 一、没有回溯的匹配
- 二、有回溯的匹配
- 三、常见的回溯形式
  
## 一、没有回溯的匹配
```js
/ab{1,3}c/
// b{1,3}表示 b 字符连续出现 1 到 3 次
// 匹配 abbbc 的时候就没有回溯
```
![没有回溯的匹配](/images/regex-回溯1.png)
## 二、有回溯的匹配
##### 案例一
如果继续使用 `/ab{1,3}c/`，将上面案例中的 `abbbc` 改成 `abbc` 中间就有回溯了，具体回溯过程如下图所示：
![有回溯的正则](/images/regex-回溯2.png)
1. 正则从首位开始匹配字符串
2. 正则中的 a 匹字符串中的 a
3. 正则中的 b{1,3} 匹配字符串中的第一个 b
4. 正则中的 b{1,3} 匹配字符串中的第二个 b
5. 正则中的 b{1,3} 匹配字符串中的 c 时，不匹配，这里就产生**回溯**
6. 这时就认为 b{1,3} 已经匹配完毕，然后状态回到之前的状态，即第 4 步
7. 最后用正则中的 c 匹配字符串中的 c，这时整个表达式匹配成功了。

##### 案例二
接下来把上例的正则改一下，`/ab{1,3}bbc/` 匹配 abbbc，匹配的过程如下：
![有回溯的正则2](/images/regex-回溯3.png)
1. 正则从首位开始匹配字符串
2. 正则中的 a 匹字符串中的 a
3. 正则中的 b{1,3} 匹配字符串中的第一个 b
4. 正则中的 b{1,3} 匹配字符串中的第二个 b
5. 正则中的 b{1,3} 匹配字符串中的第三个 b
6. 正则中的 b{1,3} 后面的 b 匹配字符串中的 c 时，不匹配
7. 这里进行回溯，回到第 4 步
8. 正则中的 b{1,3} 后面的第一个 b 匹配字符串中第三个 b
9. 正则中的 b{1,3} 后面的第二个 b 匹配字符串中的 c 时，不匹配
10. 这里进行回溯，回到第 3 步
11. 正则中的 b{1,3} 后面的第一个 b 匹配字符串中的第二个 b
12. 正则中的 b{1,3} 后面的第二个 b 匹配字符串中的第三个 b
13. 正则中的 b{1,3} 后面的 c 匹配字符串中的 c，这时整个表达式匹配成功了。

##### 案例三
正则中的 `.*` 是非常影响效率的，接下来利用 `/".*"/` 来匹配 "abc"de 分析一下过程
![有回溯的正则3](/images/regex-回溯4.png) 
:::tip
上面的正则改成 `/"[^"]"/` 就会避免不必要的回溯。
:::

## 三、常见的回溯形式
