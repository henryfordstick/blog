# 02 | JS 函数的特点：函数即对象
JS 中的函数可能会给你造成一些误解，如：可以将一个函数赋值给一个变量；还可以将函数作为一个参数传递给另外一个函数；甚至可以使得一个函数返回另外一个函数。即
**函数是一等公民**。

## 一、JS 中的对象
在 JS 中，函数就是一种特殊的对象。JS 是一门**基于对象**的语言，可以说 JS 中大部分的内容都是由对象构成的，如：函数，数组

虽然 JS 是基于对象设计的，但是它却**不是一门面向对象的语言**，面向对象语言天生支持封装、继承、多态，但是 JS 并没有直接提供多态的支持。

而 JS 中实现继承的方式却非常简单清爽，**只是在对象中添加了一个称为原型的属性，把继承的对象通过原型链接起来，就实现了继承，我们把这种继承方式称为基于原型链继承**。

其实 JavaScript 中的对象非常简单，每个对象就是由一组组属性和值构成的集合。如下面的Person对象：
```js
var person=new Object();
person.firstname="John";
person.lastname="Doe";
person.age=50;
person.eyecolor="blue";
```
![对象的构成](/images/d07e174001a29765a3575908e3704123.jpg)
虽然 JavaScript 对象用途非常广泛，使用的方式也非常之多，但是万变不离其宗，其核心本质都就是由**一组组属性和值组成的集合**，抓住了这一点，当我们再分析对象时，就会轻松很多。

改造一下上面的代码：
```js
var person = new Object();
person.firstname = "John";
person.lastname = "Doe";
person.info = new Object();
person.info.age = 50;
person.info.eyecolor = "blue";
person.showinfo = function (){
  console.log(/*...*/)
}
```
我们可以先画出这段代码的内存布局，如下图所示：
![属性值类型](/images/f73524e4cae884747ae528d999fc1117.jpg)
由上图可以看出，对象的属性值有三种类型：
- **原始类型**：主要包括 string，number，undefined，null，boolean，bigint，symbol这七种。
    - BigInt 比 Number（正负 2^53 - 1） 支持更大的整数值，`BigInt(4314354254363235) 或 4314354254363235n`。
- **对象类型**：对象的属性值也可以是另外一个对象。
- **函数类型**：对象中的属性值是函数，那么我们把这个属性称为方法。对象具备属性和方法。

## 二、函数的本质
JS 函数是一种特殊的对象，它和对象一样可以拥有属性和值，但是函数和普通对象不同的是，函数可以被调用。

V8 内部是怎么实现函数可调用特性的呢？
```js

function foo(){
    var test = 1
}
foo.myName = 1
foo.uName = 2
console.log(foo.myName)
```
![函数对象具有隐藏属性](/images/9e274227d637ce8abc4a098587613de2.jpg)
在 V8 内部，会为函数对象添加了两个隐藏属性。隐藏 name 属性的值就是函数名称，code 表示函数代码。
匿名函数的 name 属性是 anonymous。

当执行到一个函数调用语句时，V8 便会从函数对象中取出 code 属性值，也就是函数代码，然后再解释执行这段函数代码。

## 三、函数是一等公民
如果某个编程语言的函数，可以和这个语言的数据类型做一样的事情，我们就把这个语言中的函数称为一等公民。

在执行 JavaScript 函数的过程中，为了实现变量的查找，V8 会为其维护一个作用域链，如果函数中使用了某个变量，但是在函数内部又没有定义该变量，那么函数就会沿着作用域链去外部的作用域中查找该变量。

## 四、总结
- 函数作为一个对象，它有自己的属性和值，所以函数关联了基础的属性和值。
- 函数之所以成为特殊的对象，这个特殊的地方是函数可以“被调用”，所以一个函数被调用时，它还需要关联相关的执行上下文。





